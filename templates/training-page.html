{% load static %}
<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta http-equiv="X-UA-Compatible" content="ie=edge" />
    <title>{{tour.title}}</title>

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.13.1/css/all.min.css">


    <link rel="stylesheet" href="{% static 'css/tour-page/owl.carousel.min.css' %}" />
    <link rel="stylesheet" href="{% static 'css/tour-page/owl.theme.default.min.css' %}" />
    <link rel="stylesheet" href="{% static 'css/tour-page/bootstrap.min.css' %}" />
    <link rel="stylesheet" href="{% static 'css/reset.css' %}">
    <link rel="stylesheet" href="{% static 'css/organizer-page.css' %}">
    <link rel="stylesheet" href="{% static 'css/dropdown-menu-style.css' %}">
    <link rel="stylesheet" href="{% static 'css/responsive-latest.css' %}">
    <link rel="stylesheet" href="{% static 'css/tour-page/tour-page-style.css' %}" />
    <link rel="stylesheet" href="{% static 'css/tour-page/tour-page-responsive.css' %}" />
    <link rel="stylesheet" href="{% static 'css/tour-page/reset.css' %}" />

    <style>
        .info-list,
        .info-list li{
            display: flex;
        }

        .info-list li{
            margin-right: 50px;
        }

        .info-list i,
        .company-links i,
        .phone-box i{
            color: #0093E9;
            margin-right: 5px;
        }

        .company-links a:hover{
            color: #0093E9;
        }

        .company-links {
            display: flex;
            flex-direction: column;
        }

        .company-links li{
            margin-bottom: 10px;
            display: flex;
        }

        .company-links a{
            text-decoration: none;
            color: #4b4b4d;
            transition: .4s;
        }

        .d-column{
            display: flex;
            flex-direction: column;
        }
        .phone{
            color: #0093E9;
        }
        .reply-form{
            display: none;
        }
        /* stars style */

        
        
    </style>
</head>

<body>
    {% include 'partials/header.html' %}
    {% include 'partials/main-menu.html' %}
    <div class="">
            <div class="head-bottom head-bottom-img">
                <img src="{%if tour.cover%}{{tour.cover.url}}{%else%}{% static 'images/organizer/image2.jpg' %}{%endif%}" alt="" class="back-img" />
            </div>

            <div class="full-width">
                <div class="container custom-container">
                    <div class="header-content">
                        <div class="header-bottom-left">
                            <div class="company-image">
                                <img src="{%if tour.avatar%}{{tour.avatar.url}}{%else%}{% static 'images/default.png' %}{%endif%}" alt="">
                            </div>
                            <div class="image-right">
                                <div class="tour-name">
                                    <h5>{{tour.title}}</h5>
                                </div>
                                <div class="header-bottom-right">
                                    <div class="tour-location">
                                        {% if tour.city %} {{tour.city}}, {% else %} ... {%endif%} {% if tour.country %}{{tour.country}} {% else %}...{% endif %}
                                    </div>
                                    <div class="bottom-right">
                                        <div class="location">{% if tour.address %} {{tour.address}}{% else %}...{% endif %} </div>
                                        <div class="select-langs">
                                            <form action="{% url 'tour:detail' tour.id %}">
                                                <select class="select-style" name='lang' onchange="this.form.submit()">
                                                  <option value="" selected hidden disabled>{{lang|capfirst}}</option>
                                                  <option value="en">En</option>
                                                  <option value="az">Az</option>
                                                  <option value="ru">Ru</option>
                                                </select>
                                            </form>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                    </div>
                </div>
            </div>
        </div>

    <main id="main">
        <div class="cover-menu">
            <div class="container main-tour-container">
                <div class="row">
                    <div class="col-lg-7">
                        <div class="left">
                            <p class="pt-4 word">
                                {{description|capfirst}}
                            </p>
                            <nav class="details">
                                {% for i in detail %}
                                <div class="visible">
                                    <p><b>{{i.title|capfirst}}:</b></p>
                                    <p>{{i.text|capfirst}}</p>
                                </div>
                                {% endfor %} {% if detail %}
                                <span onclick="readmore()" style="color: #63a3eb;" class="readmore"><strong>Read more</strong></span> {%endif%}
                            </nav>

                        </div>
                    </div>
                    <div class="col-lg-3 middle-container tour-details">
                        <div class="middle">
                            <nav>
                                <ul>
                                    <li>
                                        <p class="price">Price</p>
                                    </li>
                                    <li>
                                        <h4>{{tour.price}} {{tour.currency}}</h4>
                                        <i class="person"> For {{tour.pricefor}} Person</i>
                                        <li ng-app="myApp" ng-controller="Main">
                                            <button ng-click="doVote()">
                                              </button>
                                            <span ng-model="like.votes">{{tour.viewcount}} views</span>
                                        </li>
                                </ul>
                            </nav>
                        </div>
                    </div>
                    <div class="col-lg-2">
                        <div class="right">
                            <p>{{tour.datefrom}} - {% if tour.dateto %}{{tour.dateto}}{%endif%}</p>
                            <div class="right-list pt-2">
                                <span><i class="fas fa-clock"></i></span>
                                <nav>
                                    <ul class="day-count-list mb-0">
                                        <li class='day'>{%if tour.durationday%} {{tour.durationday}} day {%endif%}</li>
                                        <li>{%if tour.durationnight%} {{tour.durationnight}} night {%endif%}</li>
                                    </ul>
                                </nav>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="col-lg-10 tour-details">
                        <div class="images">
                            <div class="owl-carousel owl-theme">
                                {% if image %} {% for i in image %}
                                <div class="item">
                                    <img src="{{ i.image.url }}" alt="2" />
                                </div>
                                {% endfor %} {% endif %}
                            </div>
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="col-lg-10 tour-details">
                        <div class="images">
                            <div class="owl-carousel owl-theme">
                                {% if schedule %} {% for i in schedule %}
                                <div class="item">
                                    <img src="{{ i.image.url }}" alt="2" />
                                </div>
                                {% endfor %} {% endif %}
                            </div>
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="col-lg-10 tour-details">
                        <div class="iframe-container">
                            <iframe src="https://www.google.com/maps/d/u/0/embed?mid=10HXu5tHjqhngcb9FYwZSTeYT1mcPh1vQ" ></iframe>  
                        </div>
                    </div>
                </div>
                <div class="row mb-5">
                    <div class="col-lg-10 tour-details pl-5 d-column">
                        <h3 class="full bold border-bottom pb-2 mb-3">About company</h3>
                        
                        <div class="mb-5 d-flex">
                            <div class="d-flex mr-3" style="font-weight: bold;">
                                Company Name : {{tour.organizer.organizer_name}} 
                            </div>
                            <a href="{% url 'organizer:detail' tour.organizer.id %}">
                                <i class="fas fa-external-link-alt mr-1"></i>
                                Go To {{tour.organizer.organizer_name}}
                            </a>
                        </div>

                        <div class="mb-5">
                            <h5 class="full bold border-bottom pb-2 mb-3">Description</h5>
                            <p class="description">
                                {{tour.organizer.about}}
                            </p>
                        </div>

                        <div class="d-column"> 
                            <ul class="info-list border-bottom pb-2 mb-4">
                                <li>
                                    <div class="align-center mr-1">
                                        <i class="fas fa-map-marker-alt"></i>
                                        Address : 
                                    </div>
                                    <span>{{tour.organizer.address}}</span>
                                </li>
                                <li>
                                    <div class="align-center mr-1">
                                        <i class="far fa-envelope"></i>
                                        Email : 
                                    </div>
                                    <span>{{tour.organizer.user.email}}</span>
                                </li>
                                <li>
                                    <div class="align-center mr-1">
                                        <i class="fas fa-phone-alt"></i>
                                        Number 1 : 
                                    </div>
                                    {% if tour.organizer.contact_number_1 %}
                                        <span class="phone">{{tour.organizer.contact_number_1}}</span>
                                    {% else %}
                                        <span class="phone">xxx xxx xx xx</span>
                                    {% endif %}
                                </li>
                                <li>
                                    <div class="align-center mr-1">
                                        <i class="fas fa-phone-alt"></i>
                                        Number 2 : 
                                    </div>
                                    {% if tour.organizer.contact_number_2 %}
                                        <span class="phone">{{tour.organizer.contact_number_2}}</span>
                                    {% else %}
                                        <span class="phone">xxx xxx xx xx</span>
                                    {% endif %}
                                </li>
                            </ul>
                            
                            <h3 class="full bold border-bottom pb-2 mb-3">Other Links</h3>
                            <ul class="company-links">
                                {% if url %}
                                    {% for link in url %}
                                        <li>
                                            <div class="align-center mr-1">
                                                <i class="fas fa-external-link-alt"></i>
                                            </div>
                                            <a href="{{link.url}}" target="blank">{{link.url}}</a>
                                        </li>
                                    {% endfor %} 
                                {% else %}
                                    <li>
                                        No links added
                                    </li>
                                {% endif %}
                                    
                            </ul>
                        </div>
            
                    </div>
                    
                </div>

                <div class="row">

                    {% if not request.user.is_organizer and request.user.is_authenticated %}
                        <div class="col-lg-10 tour-details pl-5">
                            <h3 class="full bold border-bottom pb-2 mb-5">Write thoughts about "{{tour.title|capfirst}}" organized by "{{tour.organizer.organizer_name}}" </h3>

                            <div class="row justify-content-center">
                                <div class="col-2">
                                    <img src="{% static 'images/chat.svg' %}" alt="" width="100%">
                                </div>
                                <div class="col-8">
                                    <form action="" method="post" id ='myform' >
                                        {% csrf_token %}
                                            <div class="form-group d-column align-items-center ">
                                                <h5 class="full bold border-bottom mb-2 pb-2">Give Your Rating</h5>
                                                <ul class="rating-menu d-column full m-0">
                                                    <li class="d-flex">
                                                        <div class="starsBox"> 
                                                            <input type="radio" id="rate-5" name="rating" value="5" > 
                                                            <label for="rate-5" class="d-flex justify-content-center align-items-center"></label> 
                                                            <input type="radio" id="rate-4" name="rating" value="4"> 
                                                            <label for="rate-4" class="d-flex justify-content-center align-items-center"></label> 
                                                            <input type="radio" id="rate-3" name="rating" value="3"> 
                                                            <label for="rate-3" class="d-flex justify-content-center align-items-center"></label> 
                                                            <input type="radio" id="rate-2" name="rating" value="2"> 
                                                            <label for="rate-2" class="d-flex justify-content-center align-items-center"></label> 
                                                            <input type="radio" id="rate-1" name="rating" value="1"> 
                                                            <label for="rate-1" class="d-flex justify-content-center align-items-center"></label> 
                                                        </div>  
                                                    </li>
                                                </ul>
                                            </div>
                                            <div class="form-group">
                                                {{form.message}}
                                            </div>
                                            <div class="form-group text-right">
                                                <input type="submit" class="btn" id="submit-comment-btn" value="Post Comment">
                                            </div>
                                    </form>
                                </div>
                            </div>
                        </div>
                    {% endif %}

                    
                    <div class="col-lg-10 commentBox tour-details pl-5 pt-5">
                        {% include 'partials/training-comments.html' %}
                    </div>
                    
                </div>
            </div>

            <div class="top-to-box">
                <button  type="button" onclick="topFunction();">Back to top </button>
            </div>
        </div>
    </main>

    <footer id="footer" class="full">
        <div class="full">
            <div class="row">
                <div class="col">
                    <ul class="foot-list">
                        <li>
                            <a href="#">About Us</a>
                        </li>
                        <li>
                            <a href="#">Terms</a>
                        </li>
                        <li>
                            <a href="#">Privacy</a>
                        </li>
                    </ul>
                    <p>© 2019</p>
                </div>
                <div class="col social-media">
                    <p>Follow Us</p>
                    <ul>
                        <li>
                            <a href="#">
                                <svg width="20" aria-hidden="true" focusable="false" data-prefix="fab" data-icon="facebook-square" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512" class="svg-inline--fa fa-facebook-square fa-w-14 fa-2x">
                        <path
                          fill="currentColor"
                          d="M400 32H48A48 48 0 0 0 0 80v352a48 48 0 0 0 48 48h137.25V327.69h-63V256h63v-54.64c0-62.15 37-96.48 93.67-96.48 27.14 0 55.52 4.84 55.52 4.84v61h-31.27c-30.81 0-40.42 19.12-40.42 38.73V256h68.78l-11 71.69h-57.78V480H400a48 48 0 0 0 48-48V80a48 48 0 0 0-48-48z"
                          class=""
                        ></path>
                      </svg>
                            </a>
                        </li>
                        <li>
                            <a href="#">
                                <svg width="20" aria-hidden="true" focusable="false" data-prefix="fab" data-icon="instagram" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512" class="svg-inline--fa fa-instagram fa-w-14 fa-2x ins-icon">
                        <path
                          fill="currentColor"
                          d="M224.1 141c-63.6 0-114.9 51.3-114.9 114.9s51.3 114.9 114.9 114.9S339 319.5 339 255.9 287.7 141 224.1 141zm0 189.6c-41.1 0-74.7-33.5-74.7-74.7s33.5-74.7 74.7-74.7 74.7 33.5 74.7 74.7-33.6 74.7-74.7 74.7zm146.4-194.3c0 14.9-12 26.8-26.8 26.8-14.9 0-26.8-12-26.8-26.8s12-26.8 26.8-26.8 26.8 12 26.8 26.8zm76.1 27.2c-1.7-35.9-9.9-67.7-36.2-93.9-26.2-26.2-58-34.4-93.9-36.2-37-2.1-147.9-2.1-184.9 0-35.8 1.7-67.6 9.9-93.9 36.1s-34.4 58-36.2 93.9c-2.1 37-2.1 147.9 0 184.9 1.7 35.9 9.9 67.7 36.2 93.9s58 34.4 93.9 36.2c37 2.1 147.9 2.1 184.9 0 35.9-1.7 67.7-9.9 93.9-36.2 26.2-26.2 34.4-58 36.2-93.9 2.1-37 2.1-147.8 0-184.8zM398.8 388c-7.8 19.6-22.9 34.7-42.6 42.6-29.5 11.7-99.5 9-132.1 9s-102.7 2.6-132.1-9c-19.6-7.8-34.7-22.9-42.6-42.6-11.7-29.5-9-99.5-9-132.1s-2.6-102.7 9-132.1c7.8-19.6 22.9-34.7 42.6-42.6 29.5-11.7 99.5-9 132.1-9s102.7-2.6 132.1 9c19.6 7.8 34.7 22.9 42.6 42.6 11.7 29.5 9 99.5 9 132.1s2.7 102.7-9 132.1z"
                          class=""
                        ></path>
                      </svg>
                            </a>
                        </li>
                        <li>
                            <a href="#">
                                <svg width="20" aria-hidden="true" focusable="false" data-prefix="fab" data-icon="linkedin" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512" class="svg-inline--fa fa-linkedin fa-w-14 fa-2x">
                        <path
                          fill="currentColor"
                          d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9V416z"
                          class=""
                        ></path>
                      </svg>
                            </a>
                        </li>
                    </ul>
                </div>
                <div class="col">
                    <a class="contact-link" href="#">Contact Us</a>
                </div>
            </div>
        </div>
    </footer>



    <script>
        details = document.querySelectorAll(".details .visible")
        for (let i = 1; i < details.length; i++) {
            details[i].style.display = "none"
        }

        function readmore() {
            if (details[1].style.display == "none") {
                document.querySelector(".readmore").innerHTML = "<strong>Read less</strong/>"
                for (let i = 1; i < details.length; i++) {
                    details[i].style.display = "block"
                }
            } else {
                document.querySelector(
                    ".readmore").innerHTML = "<strong>Read more</strong/>"
                for (let i = 1; i < details.length; i++) {
                    details[i].style.display = "none"
                }
            }
        }


    </script>

    <script src="{% static 'js/jquery-3.4.1.min.js' %}"></script>
    <script src="{% static 'js/tour-page/bootstrap.min.js' %}"></script>
    <script src="{% static 'js/tour-page/owl.carousel.js' %}"></script>
    <script src="{% static 'js/tour-page/owl.carousel.min.js' %}"></script>
    <script src="{% static 'js/tour-page/main.js' %}"></script>

    <script >
        $('#myform').on('submit', function(e){
            e.preventDefault()  
            var rating = $('input[type=radio]:checked').val()
            var textarea = $('textarea').val()
            var parent_id =  $('.parent_id').val()
            console.log(rating, textarea);
            $.ajax({
                type: "POST",
                url: $('#myform').attr('action'),
                data:  {
                    rating :rating,
                    textarea : textarea,
                    parent_id : parent_id,
                    csrfmiddlewaretoken:$('#myform').find('input[name=csrfmiddlewaretoken]').val(),
                    form_id : $('#myform').attr('id')
                },
                dataType: 'json',
                success: function (data) {
                    $('textarea').val('')
                    $('input[type=radio]:checked').prop('checked', false);
                    console.log(data, 'salamlar');
                    $('.reply-btn').click(function(){
                        $('.reply-form').hide()
                        $(this).parent().find('.reply-form').show()
                    
                    })
                    $('.commentBox').html('').load(
                        "{% url 'training:comments' tour.pk %}"
                    );
                },
                error: function(data) {
                    alert("error");
                    console.log(data);
                }
            });
        });
    

    </script>

</body>

</html>